@model tl2_tp8_2025_slackku.ViewModels.AgregarProductoViewModel
@{
    ViewData["Title"] = "Agregar Producto al Presupuesto";
}

<div class="d-flex flex-column p-3 mb-5">
    <h3>Agregar Producto al Presupuesto Nro @Model.IdPresupuesto</h3>

    <div class="container mt-2 p-4 border rounded shadow-sm">

        <div class="card border-primary mb-3">
            <div class="card-header bg-primary text-white">
                Nuevo Ítem
            </div>
            <div class="card-body">
                @if (Model.ListaProductos != null && Model.ListaProductos.Any())
                {
                    <form asp-action="AgregarProducto">
                        <input type="hidden" asp-for="IdPresupuesto" />

                        <div class="row">
                            <div class="col-md-8 mb-3">
                                <label asp-for="IdProducto" class="form-label fw-bold"></label>
                                <select asp-for="IdProducto" asp-items="@Model.ListaProductos" class="form-select">
                                    <option value="" selected disabled>Seleccionar producto...</option>
                                </select>
                                <span asp-validation-for="IdProducto" class="text-danger"></span>
                            </div>

                            <div class="col-md-4 mb-3">
                                <label asp-for="Cantidad" class="form-label fw-bold"></label>
                                <input asp-for="Cantidad" class="form-control" />
                                <span asp-validation-for="Cantidad" class="text-danger"></span>
                            </div>
                        </div>

                        <div class="d-flex justify-content-end gap-2 mt-3">
                            <input type="submit" value="Añadir Producto" class="btn btn-success" />

                            <a asp-action="Index" class="btn btn-secondary">
                                <i class="bi bi-arrow-left"></i> Volver al Presupuesto
                            </a>
                        </div>
                    </form>
                }
                else
                {
                    <div class="alert alert-warning d-flex align-items-center" role="alert">
                        <i class="bi bi-exclamation-circle-fill fs-4 me-3"></i>
                        <div>
                            <strong>No hay más productos disponibles.</strong>
                            <p class="mb-0">Todos los productos registrados en el sistema ya han sido agregados a este
                                presupuesto.</p>
                        </div>
                    </div>

                    <div class="d-flex justify-content-end mt-3">
                        <a asp-action="Index" class="btn btn-secondary">
                            <i class="bi bi-arrow-left"></i> Volver al Presupuesto
                        </a>
                    </div>
                }
            </div>
        </div>

    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
}